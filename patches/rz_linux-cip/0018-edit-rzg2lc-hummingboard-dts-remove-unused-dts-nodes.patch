From 76fbc5541f672ee0a3a5a29faafce4af1fcdefbc Mon Sep 17 00:00:00 2001
From: Yazan Shhady <yazan.shhady@solid-run.com>
Date: Sun, 4 Jun 2023 11:45:25 +0300
Subject: [PATCH] edit rzg2lc-hummingboard dts - remove unused dts nodes

---
 .../boot/dts/renesas/rzg2lc-hummingboard.dts  | 44 +---------
 .../dts/renesas/rzg2lc-sr-pinfunction.dtsi    | 43 ----------
 .../arm64/boot/dts/renesas/rzg2lc-sr-som.dtsi | 82 +------------------
 3 files changed, 6 insertions(+), 163 deletions(-)

diff --git a/arch/arm64/boot/dts/renesas/rzg2lc-hummingboard.dts b/arch/arm64/boot/dts/renesas/rzg2lc-hummingboard.dts
index 400707824c75..86ee0312be43 100644
--- a/arch/arm64/boot/dts/renesas/rzg2lc-hummingboard.dts
+++ b/arch/arm64/boot/dts/renesas/rzg2lc-hummingboard.dts
@@ -9,35 +9,13 @@
 #include <dt-bindings/pinctrl/rzg2l-pinctrl.h>
 
 /*
- * DIP-Switch SW1 setting on SoM
+ * DIP-Switch S3 setting on SoM
  * 1 : High; 0: Low
- * SW1-2 : SW_SD0_DEV_SEL	(1: eMMC; 0: uSD)
- * SW1-3 : SW_SCIF_CAN		(1: CAN1; 0: SCIF1)
- * SW1-4 : SW_RSPI_CAN		(1: CAN1; 0: RSPI1)
- * Please change below macros according to SW1 setting
+ * S3[1] : SW_SD0_DEV_SEL	(1: eMMC; 0: uSD)
  */
 
 #define SW_SD0_DEV_SEL	0
 
-#define SW_SCIF_CAN	0
-#if (SW_SCIF_CAN)
-/* Due to HW routing, SW_RSPI_CAN is always 0 when SW_SCIF_CAN is set to 1 */
-#define SW_RSPI_CAN	0
-#define SCIF1_GPT3	1 /* Enable GPT3 when SCIF1 disabled */
-#else
-/* Please set SW_RSPI_CAN. Default value is 1 */
-#define SW_RSPI_CAN	1
-#endif
-
-#if (SW_SCIF_CAN & SW_RSPI_CAN)
-#error "Can not set 1 to both SW_SCIF_CAN and SW_RSPI_CAN due to HW routing"
-#endif
-
-/* comment the #define statement to disable SCIF1 (SER0) on PMOD1 (CN7) */
-#define PMOD1_SER0	1
-/* Select function support POEGD (1: enabled, 0 : disabled) */
-#define POEGD_SUPPORT	1
-
 /dts-v1/;
 #include "rzg2lc-sr-som.dtsi"
 #include "rzg2lc-sr-pinfunction.dtsi"
@@ -135,14 +113,6 @@ &du {
 	status = "okay";
 };
 
-/*
- * To enable SCIF1 (SER0) on PMOD1 (CN7), On connector board
- * SW1 should be at position 2->3 so that SER0_CTS# line is activated
- * SW2 should be at position 2->3 so that SER0_TX line is activated
- * SW3 should be at position 2->3 so that SER0_RX line is activated
- * SW4 should be at position 2->3 so that SER0_RTS# line is activated
- */
-#if (!SW_SCIF_CAN && PMOD1_SER0 && !SCIF1_GPT3)
 &scif1 {
 	pinctrl-0 = <&scif1_pins>;
 	pinctrl-names = "default";
@@ -150,25 +120,15 @@ &scif1 {
 	//uart-has-rtscts;
 	status = "okay";
 };
-#endif
 
-#if ((SW_SCIF_CAN || SW_RSPI_CAN) && !MTU3_PWM_SUPPORT)
-&canfd {
-	pinctrl-0 = <&can1_pins>;
-	/delete-node/ channel0;
-};
-#else
 &canfd {
 	/delete-property/ pinctrl-0;
 	/delete-property/ pinctrl-names;
 	status = "disabled";
 };
-#endif
 
-#if (SW_RSPI_CAN)
 &spi1 {
 	/delete-property/ pinctrl-0;
 	/delete-property/ pinctrl-names;
 	status = "disabled";
 };
-#endif
diff --git a/arch/arm64/boot/dts/renesas/rzg2lc-sr-pinfunction.dtsi b/arch/arm64/boot/dts/renesas/rzg2lc-sr-pinfunction.dtsi
index c6350f7b2dec..7412d8c1cb7a 100644
--- a/arch/arm64/boot/dts/renesas/rzg2lc-sr-pinfunction.dtsi
+++ b/arch/arm64/boot/dts/renesas/rzg2lc-sr-pinfunction.dtsi
@@ -12,29 +12,6 @@ &pinctrl {
 	pinctrl-0 = <&sound_clk_pins>;
 	pinctrl-names = "default";
 
-#if SW_SCIF_CAN
-	/* SW8 should be at position 2->1 */
-	can1_pins: can1 {
-		pinmux = <RZG2L_PORT_PINMUX(40, 0, 3)>, /* TxD */
-			 <RZG2L_PORT_PINMUX(40, 1, 3)>; /* RxD */
-	};
-#endif
-
-#if (SW_RSPI_CAN && !MTU3_PWM_SUPPORT)
-	/* SW8 should be at position 2->3 so that GPIO9_CAN1_STB line is activated */
-	can1-stb-hog {
-		gpio-hog;
-		gpios = <RZG2L_GPIO(44, 3) GPIO_ACTIVE_HIGH>;
-		output-low;
-		line-name = "can1_stb";
-	};
-
-	can1_pins: can1 {
-		pinmux = <RZG2L_PORT_PINMUX(44, 0, 3)>, /* TxD */
-			 <RZG2L_PORT_PINMUX(44, 1, 3)>; /* RxD */
-	};
-#endif
-
 	i2c0_pins: i2c0 {
 		pins = "RIIC0_SDA", "RIIC0_SCL";
 		input-enable;
@@ -50,29 +27,17 @@ i2c2_pins: i2c2 {
 			 <RZG2L_PORT_PINMUX(42, 4, 1)>; /* SCL */
 	};
 
-#if (MTU3_PWM_SUPPORT)
-	mtu3_pins: mtu3 {
-		pinmux =
-			<RZG2L_PORT_PINMUX(44, 0, 4)>, /* MTIOC3A */
-			<RZG2L_PORT_PINMUX(44, 1, 4)>, /* MTIOC3B */
-			<RZG2L_PORT_PINMUX(44, 2, 4)>, /* MTIOC3C */
-			<RZG2L_PORT_PINMUX(44, 3, 4)>; /* MTIOC3D */
-	};
-#endif
-
 	scif0_pins: scif0 {
 		pinmux = <RZG2L_PORT_PINMUX(38, 0, 1)>,	/* TxD */
 			 <RZG2L_PORT_PINMUX(38, 1, 1)>;	/* RxD */
 	};
 
-#if (!SCIF1_GPT3)
 	scif1_pins: scif1 {
 		pinmux = <RZG2L_PORT_PINMUX(40, 0, 1)>, /* TxD */
 			 <RZG2L_PORT_PINMUX(40, 1, 1)>, /* RxD */
 			 <RZG2L_PORT_PINMUX(41, 0, 1)>, /* CTS# */
 			 <RZG2L_PORT_PINMUX(41, 1, 1)>; /* RTS# */
 	};
-#endif
 
 	sd1-pwr-en-hog {
 		gpio-hog;
@@ -118,14 +83,12 @@ sound_clk_pins: sound_clk {
 		input-enable;
 	};
 
-#if (!MTU3_PWM_SUPPORT)
 	spi1_pins: spi1 {
 		pinmux = <RZG2L_PORT_PINMUX(44, 0, 1)>, /* CK */
 			 <RZG2L_PORT_PINMUX(44, 1, 1)>, /* MOSI */
 			 <RZG2L_PORT_PINMUX(44, 2, 1)>, /* MISO */
 			 <RZG2L_PORT_PINMUX(44, 3, 1)>; /* SSL */
 	};
-#endif
 
 	ssi0_pins: ssi0 {
 		pinmux = <RZG2L_PORT_PINMUX(45, 0, 1)>, /* BCK */
@@ -142,10 +105,4 @@ usb1_pins: usb1 {
 		pinmux = <RZG2L_PORT_PINMUX(5, 0, 1)>; /* VBUS */
 	};
 
-#if (SCIF1_GPT3)
-	gpt3_pins: gpt3 {
-		pinmux = <RZG2L_PORT_PINMUX(41, 0, 4)>, /* Channel A */
-			 <RZG2L_PORT_PINMUX(41, 1, 4)>; /* Channel B */
-	};
-#endif
 };
diff --git a/arch/arm64/boot/dts/renesas/rzg2lc-sr-som.dtsi b/arch/arm64/boot/dts/renesas/rzg2lc-sr-som.dtsi
index 2f6034af1144..278dd4a1fa1d 100644
--- a/arch/arm64/boot/dts/renesas/rzg2lc-sr-som.dtsi
+++ b/arch/arm64/boot/dts/renesas/rzg2lc-sr-som.dtsi
@@ -12,26 +12,6 @@
 #include <dt-bindings/gpio/gpio.h>
 #include <dt-bindings/pinctrl/rzg2l-pinctrl.h>
 
-/*
- * MTU3 macros are created to support setting pinctrl and properties in order
- * to use MTU3 functions. However, their pins on PMOD0 are mixed with SPI1,
- * so we must disable this module to avoid conflict.
- * - MTU3_PWM_SUPPORT: Disable SPI1 to support PWM functions of channel3.
- *   By default, PWM mode 1 of MTIOC3C will be selected.
- * - MTU3_PWM_COMPLEMENTARY_SELECT: Enable this macro to select complementary PWM
- *   mode of MTIOC3B and MTIOC3D instead of PWM mode 1. This mode depends on macro
- *   MTU3_PWM_SUPPORT.
- */
-#define MTU3_PWM_SUPPORT			0
-#define MTU3_PWM_COMPLEMENTARY_SELECT		0
-
-/*
- * POE3_SUPPORT is used to enable POE3 to control Hi-Z state of complementary PWM
- * signals at MTIOC3B-MTIOC3D. Note: This macro must be enabled along with macros
- * MTU3_PWM_SUPPORT and MTU3_PWM_COMPLEMENTARY_SELECT to fully take effect.
- */
-#define POE3_SUPPORT				0
-
 / {
 	aliases {
     serial0 = &scif0;
@@ -162,7 +142,6 @@ &eth0 {
 	status = "okay";
 
 	phy0: ethernet-phy@0 {
-    //compatible = "ethernet-phy-id0283.bc30", "ethernet-phy-ieee802.3-c22";
 		reg = <0>;
 		max-speed = <100>;  /* configure ethernet max speed for ethernet0 */
 		rxc-skew-psec = <2400>;
@@ -234,11 +213,10 @@ qspi0-ctrl {
 	};
 
 	/*
-	 * SD0 device selection is XOR between GPIO_SD0_DEV_SEL and SW1[2]
 	 * The below switch logic can be used to select the device between
 	 * eMMC and microSD, after setting GPIO_SD0_DEV_SEL to high in DT.
-	 * SW1[2] should be at OFF position to enable 64 GB eMMC
-	 * SW1[2] should be at position ON to enable uSD card CN3
+	 * S3[1] should be at OFF position to enable eMMC
+	 * S3[1] should be at position ON to enable uSD card
 	 */
 
 	/*
@@ -313,47 +291,7 @@ sd0_mux_uhs {
 &sbc {
 	pinctrl-0 = <&qspi0_pins>;
 	pinctrl-names = "default";
-	status = "okay";
-
-	flash@0 {
-		compatible = "micron,mt25qu512a", "jedec,spi-nor";
-		reg = <0>;
-		m25p,fast-read;
-		spi-max-frequency = <50000000>;
-		spi-rx-bus-width = <4>;
-		spi-tx-bus-width = <4>;
-
-		partitions {
-			compatible = "fixed-partitions";
-			#address-cells = <1>;
-			#size-cells = <1>;
-
-			partition@0000000 {
-				label = "u-boot";
-				reg = <0x00000000 0x80000>;
-				read-only;
-			};
-			partition@80000 {
-				label = "env";
-				reg = <0x00080000 0x40000>;
-				read-only;
-			};
-			partition@C0000 {
-				label = "dtb";
-				reg = <0x000C0000 0x40000>;
-				read-only;
-			};
-			partition@800000 {
-				label = "rootfs";
-				/* 16MB @ 8MB offset in SPI Flash */
-				reg = <0x00800000 0x01000000>;
-			};
-			partition@2000000 {
-				label = "test-area";
-				reg = <0x02000000 0x00100000>;
-			};
-		};
-	};
+	status = "disabled";
 };
 
 #if (!SW_SD0_DEV_SEL)
@@ -443,17 +381,7 @@ rtc: isl1208@6f {
 };
 
 &canfd {
-	pinctrl-0 = <&can0_pins &can1_pins>;
-	pinctrl-names = "default";
-	status = "okay";
-
-	channel0 {
-		status = "okay";
-	};
-
-	channel1 {
-		status = "okay";
-	};
+	status = "disabled";
 };
 
 &ehci0 {
@@ -555,7 +483,6 @@ &vccq_sdhi1 {
   gpios = <&pinctrl RZG2L_GPIO(23, 0) GPIO_ACTIVE_HIGH>;
 };
 
-#if (!MTU3_PWM_SUPPORT)
 &spi1 {
 	pinctrl-0 = <&spi1_pins>;
 	pinctrl-names = "default";
@@ -564,7 +491,6 @@ &spi1 {
 
 	status = "okay";
 };
-#endif
 
 &usb2_phy0 {
 	pinctrl-0 = <&usb0_pins>;
-- 
2.25.1

