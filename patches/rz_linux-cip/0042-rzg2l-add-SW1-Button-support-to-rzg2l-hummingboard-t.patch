From c7aa489f2f3d2ed83f2e78996389f85ab7a9ac24 Mon Sep 17 00:00:00 2001
From: Yazan Shhady <yazan.shhady@solid-run.com>
Date: Mon, 28 Aug 2023 16:43:31 +0300
Subject: [PATCH] rzg2l: add SW1 Button support to rzg2l-hummingboard-tutus

---
 .../dts/renesas/rzg2l-hummingboard-tutus.dts     | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)

diff --git a/arch/arm64/boot/dts/renesas/rzg2l-hummingboard-tutus.dts b/arch/arm64/boot/dts/renesas/rzg2l-hummingboard-tutus.dts
index 0641cf527ab7..b1dc76723c3d 100644
--- a/arch/arm64/boot/dts/renesas/rzg2l-hummingboard-tutus.dts
+++ b/arch/arm64/boot/dts/renesas/rzg2l-hummingboard-tutus.dts
@@ -7,6 +7,7 @@
 
 #include <dt-bindings/gpio/gpio.h>
 #include <dt-bindings/pinctrl/rzg2l-pinctrl.h>
+#include <dt-bindings/input/input.h>
 
 /*
  * DIP-Switch S3 setting on SoM
@@ -52,6 +53,21 @@ LED-B-hog {
 		};
 	};
 
+	/*poll RZ_P16_0 (SW1 Button) and reboot if the button is pressed*/
+	gpio_keys_polled {
+		compatible = "gpio-keys-polled";
+		#address-cells = <1>;
+		#size-cells = <0>;
+		poll-interval = <1000>; /*1 sec*/
+		autorepeat; /*for cases when key was triggered before daemon was started*/
+		button@0 {
+			label = "reset";
+			linux,code = <KEY_RESTART>;
+			gpios = <&pinctrl RZG2L_GPIO(16, 0) GPIO_ACTIVE_LOW>;
+			debounce-interval = <100>;
+		};
+	};
+
 };
 
 &pinctrl {
-- 
2.25.1

