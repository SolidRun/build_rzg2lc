From f074123cfa780c0561d17d6da7a806345b542ea5 Mon Sep 17 00:00:00 2001
From: Mikhail Anikin <mikhail.anikin@solid-run.com>
Date: Thu, 19 Oct 2023 09:34:41 +0300
Subject: [PATCH] SR RZ SOMs: Fix OTG mode. RZG2LC: move hdmi-out node from som
 dts

---
 arch/arm64/boot/dts/renesas/rzg2l-sr-som.dtsi       |  1 +
 arch/arm64/boot/dts/renesas/rzg2lc-hummingboard.dts | 11 +++++++++++
 arch/arm64/boot/dts/renesas/rzg2lc-sr-som.dtsi      | 12 +-----------
 arch/arm64/boot/dts/renesas/rzv2l-sr-som.dtsi       |  1 +
 4 files changed, 14 insertions(+), 11 deletions(-)

diff --git a/arch/arm64/boot/dts/renesas/rzg2l-sr-som.dtsi b/arch/arm64/boot/dts/renesas/rzg2l-sr-som.dtsi
index c2da8c043..54d6308cf 100644
--- a/arch/arm64/boot/dts/renesas/rzg2l-sr-som.dtsi
+++ b/arch/arm64/boot/dts/renesas/rzg2l-sr-som.dtsi
@@ -517,6 +517,7 @@ &spi1 {
 &usb2_phy0 {
 	vbus-supply = <&usb0_vbus_otg>;
 	status = "okay";
+	renesas,no-otg-pins;
 };
 
 &usb2_phy1 {
diff --git a/arch/arm64/boot/dts/renesas/rzg2lc-hummingboard.dts b/arch/arm64/boot/dts/renesas/rzg2lc-hummingboard.dts
index 2e97f4073..924ad8420 100644
--- a/arch/arm64/boot/dts/renesas/rzg2lc-hummingboard.dts
+++ b/arch/arm64/boot/dts/renesas/rzg2lc-hummingboard.dts
@@ -29,6 +29,17 @@ x1_clk: x1-clock {
 		#clock-cells = <0>;
 		clock-frequency = <24000000>;
 	};
+
+	hdmi-out {
+		compatible = "hdmi-connector";
+		type = "d";
+
+		port {
+			hdmi_con_out: endpoint {
+			remote-endpoint = <&adv7535_out>;
+			};
+		};
+	};
 };
 
 &pinctrl {
diff --git a/arch/arm64/boot/dts/renesas/rzg2lc-sr-som.dtsi b/arch/arm64/boot/dts/renesas/rzg2lc-sr-som.dtsi
index 7b4dfbf5b..7e4bd5f88 100644
--- a/arch/arm64/boot/dts/renesas/rzg2lc-sr-som.dtsi
+++ b/arch/arm64/boot/dts/renesas/rzg2lc-sr-som.dtsi
@@ -113,17 +113,6 @@ vccq_sdhi1: regulator-vccq-sdhi1 {
 	gpio = <&pinctrl RZG2L_GPIO(23, 0) GPIO_ACTIVE_HIGH>;
 	enable-active-high;
   };
-
-  hdmi-out {
-    compatible = "hdmi-connector";
-    type = "d";
-
-    port {
-      hdmi_con_out: endpoint {
-        remote-endpoint = <&adv7535_out>;
-      };
-    };
-  };
 };
 
 &eth0 {
@@ -490,6 +479,7 @@ &spi1 {
 &usb2_phy0 {
 	vbus-supply = <&usb0_vbus_otg>;
 	status = "okay";
+	renesas,no-otg-pins;
 };
 
 &usb2_phy1 {
diff --git a/arch/arm64/boot/dts/renesas/rzv2l-sr-som.dtsi b/arch/arm64/boot/dts/renesas/rzv2l-sr-som.dtsi
index 29887f5ef..ebe9252e1 100644
--- a/arch/arm64/boot/dts/renesas/rzv2l-sr-som.dtsi
+++ b/arch/arm64/boot/dts/renesas/rzv2l-sr-som.dtsi
@@ -535,6 +535,7 @@ &spi1 {
 &usb2_phy0 {
 	vbus-supply = <&usb0_vbus_otg>;
 	status = "okay";
+	renesas,no-otg-pins;
 };
 
 &usb2_phy1 {
-- 
2.41.0

